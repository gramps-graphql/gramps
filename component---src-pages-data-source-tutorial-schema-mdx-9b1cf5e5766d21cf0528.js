(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{384:function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return o})),n.d(t,"default",(function(){return d}));n(11),n(5),n(6),n(2),n(10),n(1),n(0);var a=n(103),r=n(395);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var o={},s=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(a.b)("div",t)}},l=s("AnchorLinks"),c=s("AnchorLink"),p={_frontmatter:o},b=r.a;function d(e){var t=e.components,n=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,["components"]);return Object(a.b)(b,i({},p,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,"At this point, we’ve ",Object(a.b)("a",i({parentName:"p"},{href:"/data-source-tutorial/connector"}),"set up a connector")," to tell our data source where data comes from, and ",Object(a.b)("a",i({parentName:"p"},{href:"/data-source-tutorial/model"}),"defined data access methods in a model")," to make requests for specific types of data. In this section, we’ll create a GraphQL schema to describe our data."),Object(a.b)("h2",{id:"table-of-contents"},"Table of Contents"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",i({parentName:"li"},{href:"/data-source-tutorial/setup"}),"Initial Data Source Setup")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",i({parentName:"li"},{href:"/data-source-tutorial/connector"}),"Create a Connector")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",i({parentName:"li"},{href:"/data-source-tutorial/model"}),"Create a Model")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("strong",{parentName:"li"},"> ",Object(a.b)("a",i({parentName:"strong"},{href:"/data-source-tutorial/schema"}),"Write a GraphQL Schema"))),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",i({parentName:"li"},{href:"/data-source-tutorial/resolvers"}),"Write Resolvers")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",i({parentName:"li"},{href:"/data-source-tutorial/dev"}),"Use Development Modes"))),Object(a.b)("h2",{id:"in-this-section"},"In This Section"),Object(a.b)(l,{mdxType:"AnchorLinks"},Object(a.b)(c,{mdxType:"AnchorLink"},"Remove the Example Query and Type"),Object(a.b)(c,{mdxType:"AnchorLink"},"Extend the Query Type"),Object(a.b)(c,{mdxType:"AnchorLink"},"Define an Input Type"),Object(a.b)(c,{mdxType:"AnchorLink"},"Define Field Types")),Object(a.b)("h2",{id:"remove-the-example-query-and-type"},"Remove the Example Query and Type"),Object(a.b)("p",null,"To get set up, let’s start by removing the example query and type in ",Object(a.b)("inlineCode",{parentName:"p"},"src/schema.graphql"),"."),Object(a.b)("pre",null,Object(a.b)("code",i({parentName:"pre"},{className:"language-diff"}),"  # The query/queries for data access MUST extend the Query type.\n  extend type Query {\n-   # TODO: rename and add a description of this query\n-   YourDataSource(\n-     # TODO: Describe this argument\n-     id: ID!\n-   ): PFX_YourDataSource\n  }\n\n- # TODO: Choose a unique prefix and rename the type descriptively.\n- type PFX_YourDataSource {\n-   # The unique ID of the thing.\n-   id: ID!\n-   # Describe each field to help people use the data more effectively.\n-   name: String\n-   lucky_numbers: [Int]\n- }\n")),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},Object(a.b)("strong",{parentName:"p"},"NOTE:")," If you’re not familiar with the syntax for GraphQL schemas,\n",Object(a.b)("a",i({parentName:"p"},{href:"http://graphql.org/learn/schema/"}),"read the GraphQL docs")," for more info.")),Object(a.b)("h2",{id:"extend-the-query-type"},"Extend the Query Type"),Object(a.b)("p",null,"In order to make GraphQL queries, we need to extend the ",Object(a.b)("inlineCode",{parentName:"p"},"Query")," type. ",Object(a.b)("strong",{parentName:"p"},"This is a GrAMPS-specific feature that allows GrAMPS data sources to be combined without transpilation.")),Object(a.b)("p",null,"Let’s add our ",Object(a.b)("inlineCode",{parentName:"p"},"searchMoviesByTitle")," query:"),Object(a.b)("pre",null,Object(a.b)("code",i({parentName:"pre"},{className:"language-diff"}),"  extend type Query {\n+   # Search for a movie by its title and (optionally) release year.\n+   searchMoviesByTitle(\n+     # Argument object with the title and year to search for.\n+     options: IMDB_MovieSearchInput\n+   ): [IMDB_Movie]\n  }\n")),Object(a.b)("p",null,"We’ll only look at the ",Object(a.b)("inlineCode",{parentName:"p"},"searchMoviesByTitle")," part of the schema in this tutorial, but you can see the full schema ",Object(a.b)("a",i({parentName:"p"},{href:"https://github.com/gramps-graphql/data-source-imdbapi/blob/master/src/schema.graphql"}),"on GitHub"),"."),Object(a.b)("h2",{id:"define-an-input-type"},"Define an Input Type"),Object(a.b)("p",null,"To make sure our query is easy to use, but still strongly typed, we’re using an ",Object(a.b)("a",i({parentName:"p"},{href:"http://graphql.org/graphql-js/mutations-and-input-types/"}),"input type")," to define arguments. In the case of our movie search, the possible arguments are the name of the movie (required) and the year it was released (optional). Let’s add that to the schema."),Object(a.b)("pre",null,Object(a.b)("code",i({parentName:"pre"},{className:"language-gql"}),"input IMDB_MovieSearchInput {\n  # The title of the movie to search for (e.g. “Ready Player One”).\n  title: String!\n\n  # (Optional) The year the movie was released.\n  year: String\n}\n")),Object(a.b)("h2",{id:"define-field-types"},"Define Field Types"),Object(a.b)("p",null,"Next, we need to map the API responses to GraphQL types. To do this, let’s take a look at the response (with some values edited for space) from the database for a movie search:"),Object(a.b)("pre",null,Object(a.b)("code",i({parentName:"pre"},{className:"language-json"}),'[\n  {\n    "title": "Ready Player One",\n    "content_rating": "",\n    "original_title": "",\n    "metadata": {\n      "languages": [\n        "English"\n      ],\n      "asp_retio": "2.35 : 1",\n      "filming_locations": [\n        "Jewellery Quarter",\n        "Birmingham",\n        "England",\n        "UK"\n      ],\n      "also_known_as": [\n        "Jogador N&#186; 1"\n      ],\n      "countries": [\n        "USA"\n      ],\n      "gross": "",\n      "sound_mix": [\n        "Dolby Digital",\n        "Auro 11.1",\n        "Dolby Atmos"\n      ],\n      "budget": ""\n    },\n    "release_date": "2018-03-30",\n    "director": "Steven Spielberg",\n    "url": {\n      "url": "http://www.imdb.com/title/tt1677720"\n    },\n    "year": "2018",\n    "trailer": [\n      {\n        "mimeType": "video/mp4",\n        "definition": "720p",\n        "videoUrl": "https://video-http.media-imdb.com/M....mp4"\n      },\n      // ...\n    ],\n    "length": "",\n    "cast": [\n      {\n        "character": "The Iron Giant       (voice)",\n        "image": "https://images-na.ssl-images-amazon.com/images/M/....jpg",\n        "link": "http://www.imdb.com/name/nm0004874/?ref_=tt_cl_t1",\n        "name": "Vin Diesel"\n      },\n      // ...\n    ],\n    "imdb_id": "tt1677720",\n    "rating": "",\n    "genre": [\n      "Action",\n      "Adventure",\n      "Sci-Fi"\n    ],\n    "rating_count": "",\n    "storyline": "Film centers on...",\n    "description": "When the creator...",\n    "writers": [\n      "Zak Penn",\n      "Ernest Cline"\n    ],\n    "stars": [\n      "Vin Diesel",\n      "Olivia Cooke",\n      "Hannah John-Kamen"\n    ],\n    "poster": {\n      "large": "https://images-na.ssl-images-amazon.com/images/M/....jpg",\n      "thumb": "https://images-na.ssl-images-amazon.com/images/M/....jpg"\n    }\n  }\n]\n')),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},Object(a.b)("strong",{parentName:"p"},"NOTE:")," There’s a typo in the API response, where “ratio” is misspelled “retio” — we’ll address that in our schema.")),Object(a.b)("p",null,"To convert this to a GraphQL type, we go field-by-field and add them, each with its corresponding type. Fields that return objects become their own types."),Object(a.b)("p",null,"To avoid collisions with other GrAMPS data sources, we’ll add a prefix of ",Object(a.b)("inlineCode",{parentName:"p"},"IMDB_")," to each type."),Object(a.b)("p",null,"Add the following to ",Object(a.b)("inlineCode",{parentName:"p"},"src/schema.graphql")," to define the movie type:"),Object(a.b)("pre",null,Object(a.b)("code",i({parentName:"pre"},{className:"language-gql"}),"type IMDB_Movie {\n  cast: [IMDB_Cast]!\n  content_rating: String!\n  description: String!\n  director: String!\n  genre: [String]!\n  imdb_id: String!\n  length: String!\n  metadata: IMDB_Metadata!\n  original_title: String!\n  poster: IMDB_Poster!\n  rating: String!\n  rating_count: String!\n  release_date: String!\n  stars: [String]!\n  storyline: String!\n  title: String!\n  trailer: [IMDB_Trailer]!\n  url: IMDB_Url!\n  writers: [String]!\n  year: String!\n}\n\ntype IMDB_Cast {\n  character: String!\n  image: String!\n  link: String!\n  name: String!\n}\n\ntype IMDB_Metadata {\n  also_known_as: [String]!\n  # The aspect ratio of the film.\n  #\n  # NOTE: This field has a typo on the API (`asp_retio`).\n  asp_ratio: String!\n  budget: String!\n  countries: [String]!\n  filming_locations: [String]!\n  gross: String!\n  languages: [String]!\n  sound_mix: [String]!\n}\n\ntype IMDB_Poster {\n  large: String!\n  thumb: String!\n}\n\ntype IMDB_Trailer {\n  definition: String!\n  mimeType: String!\n  videoUrl: String!\n}\n\ntype IMDB_Url {\n  title: String\n  url: String!\n  year: String\n}\n")),Object(a.b)("h2",{id:"next-up-write-resolvers"},"Next Up: Write Resolvers"),Object(a.b)("p",null,"At this point, we’ve got a way to get data, and a definition for how someone can access data — all that’s left now is to connect the API data to our GraphQL schema with resolvers."))}d.isMDXComponent=!0},393:function(e){e.exports=JSON.parse('{"data":{"site":{"pathPrefix":""}}}')},394:function(e){e.exports=JSON.parse('{"data":{"site":{"siteMetadata":{"repository":{"baseUrl":"","subDirectory":""}}}}}')},395:function(e,t,n){"use strict";n(35),n(27);var a=n(1),r=n(393),i=n(0),o=n.n(i),s=n(102),l=n.n(s),c=n(188),p=n(121),b=n(3),d=n.n(b),u=n(373),m=function(e){var t,n=e.title,r=e.tabs,i=void 0===r?[]:r;return Object(a.b)("div",{className:d()(u.pageHeader,(t={},t[u.withTabs]=i.length,t))},Object(a.b)("div",{className:"bx--grid"},Object(a.b)("div",{className:"bx--row"},Object(a.b)("div",{className:"bx--col-lg-12"},Object(a.b)("h1",{id:"page-title",className:u.text},n)))))},h=n(394),g=n(374),y=function(e){var t=e.relativePagePath,n=e.repository,r=h.data.site.siteMetadata.repository,i=n||r,o=i.baseUrl,s=o+"/tree/master"+i.subDirectory+"/src/pages"+t;return o?Object(a.b)("div",{className:"bx--row "+g.row},Object(a.b)("div",{className:"bx--col"},Object(a.b)("a",{className:g.link,href:s},"Edit this page on GitHub"))):null},O=n(186),f=n(28),j=n(375);var v=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,r.prototype.render=function(){var e=this.props,t=e.tabs,n=e.slug,r=n.split("/").filter(Boolean).slice(-1)[0],i=t.map((function(e){var t,i=l()(e,{lower:!0}),o=i===r,s=n.replace(r,i);return Object(a.b)("li",{key:e,className:d()((t={},t[j.selectedItem]=o,t),j.listItem)},Object(a.b)(f.Link,{className:j.link,to:""+s},e))}));return Object(a.b)("div",{className:j.tabsContainer},Object(a.b)("div",{className:"bx--grid"},Object(a.b)("div",{className:"bx--row"},Object(a.b)("div",{className:"bx--col-lg-12 bx--col-no-gutter"},Object(a.b)("nav",null,Object(a.b)("ul",{className:j.list},i))))))},r}(o.a.Component),N=n(187);t.a=function(e){var t=e.pageContext,n=e.children,i=e.location,o=t.frontmatter,s=void 0===o?{}:o,b=t.relativePagePath,d=t.titleType,u=s.tabs,h=s.title,g=s.theme,f=s.description,j=s.keywords,S=r.data.site.pathPrefix,w=S?i.pathname.replace(S,""):i.pathname,T=u?w.split("/").slice(-1)[0]||l()(u[0],{lower:!0}):"";return Object(a.b)(p.a,{homepage:!1,theme:g,pageTitle:h,pageDescription:f,pageKeywords:j,titleType:d},Object(a.b)(m,{title:h,label:"label",tabs:u}),u&&Object(a.b)(v,{slug:w,tabs:u,currentTab:T}),Object(a.b)(N.a,{padded:!0},n,Object(a.b)(y,{relativePagePath:b})),Object(a.b)(O.a,{pageContext:t,location:i,slug:w,tabs:u,currentTab:T}),Object(a.b)(c.a,null))}}}]);
//# sourceMappingURL=component---src-pages-data-source-tutorial-schema-mdx-9b1cf5e5766d21cf0528.js.map